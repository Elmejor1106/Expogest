<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Nueva Solicitud de Stand - ExpoGest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <div th:replace="~{fragments/navbar :: styles}"></div>
    <style>
        .evento-card {
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }
        .evento-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(255,214,0,0.3);
        }
    </style>
</head>
<body>

<!-- Navbar -->
<div th:replace="~{fragments/navbar :: navbar('Expositor', '/expositor/panelExpositor')}"></div>

<div class="container py-4">
    <!-- Mensajes -->
    <div th:if="${mensaje}" th:class="'alert alert-' + ${tipo} + ' alert-dismissible fade show'" role="alert">
        <span th:text="${mensaje}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-calendar-check text-success"></i> Seleccione un Evento</h2>
        <div>
            <a th:href="@{/solicitudes/mis-solicitudes}" class="btn btn-outline-secondary me-2">
                <i class="bi bi-list-check"></i> Mis Solicitudes
            </a>
            <a th:href="@{/expositor/panelExpositor}" class="btn btn-outline-primary">
                <i class="bi bi-arrow-left"></i> Volver
            </a>
        </div>
    </div>

    <!-- Instrucciones -->
    <div class="alert alert-info">
        <i class="bi bi-info-circle"></i>
        <strong>¿Cómo solicitar un stand?</strong>
        <ol class="mb-0 mt-2">
            <li>Seleccione el evento en el que desea participar</li>
            <li>Elija un stand disponible del evento</li>
            <li>Complete la descripción de su empresa/producto</li>
            <li>Envíe su solicitud y espere la aprobación del organizador</li>
        </ol>
    </div>

    <!-- Eventos Activos -->
    <h4 class="mb-3">Eventos Activos Disponibles</h4>

    <div th:if="${eventos.empty}" class="text-center py-5">
        <i class="bi bi-calendar-x" style="font-size: 5rem; color: #ccc;"></i>
        <h3 class="mt-3 text-muted">No hay eventos activos</h3>
        <p class="text-muted">Por el momento no hay eventos disponibles para solicitar stands</p>
        <a th:href="@{/expositor/panelExpositor}" class="btn btn-primary mt-3">
            <i class="bi bi-house"></i> Volver al Panel
        </a>
    </div>

    <div class="row">
        <div th:each="evento : ${eventos}" class="col-md-6 col-lg-4 mb-4">
            <div class="card evento-card h-100 shadow" 
                 onclick="location.href='/solicitudes/nueva/' + '[[${evento.id}]]'">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-calendar-event"></i>
                        <span th:text="${evento.nombre}"></span>
                    </h5>
                </div>
                <div class="card-body">
                    <!-- Descripción -->
                    <p class="card-text" th:text="${evento.descripcion}"></p>

                    <!-- Fechas -->
                    <div class="mb-2">
                        <i class="bi bi-calendar-range text-primary"></i>
                        <strong>Fechas:</strong><br>
                        <small>
                            <span th:text="${#temporals.format(evento.fechaInicio, 'dd/MM/yyyy')}"></span> - 
                            <span th:text="${#temporals.format(evento.fechaFin, 'dd/MM/yyyy')}"></span>
                        </small>
                    </div>

                    <!-- Ubicación -->
                    <div class="mb-2">
                        <i class="bi bi-geo-alt text-danger"></i>
                        <strong>Ubicación:</strong>
                        <span th:if="${evento.latitud != null && evento.longitud != null}">
                            <span th:text="${#numbers.formatDecimal(evento.latitud, 1, 4)}"></span>,
                            <span th:text="${#numbers.formatDecimal(evento.longitud, 1, 4)}"></span>
                        </span>
                        <span th:if="${evento.latitud == null || evento.longitud == null}" class="text-warning">
                            Sin ubicación
                        </span>
                    </div>

                    <!-- Capacidad -->
                    <div class="mb-2">
                        <i class="bi bi-shop text-success"></i>
                        <strong>Capacidad:</strong>
                        <span th:text="${evento.capacidadMaximaStands}"></span> stands
                    </div>

                    <!-- Estado -->
                    <div class="mt-3">
                        <span class="badge bg-success">
                            <i class="bi bi-check-circle"></i> Activo
                        </span>
                    </div>
                </div>
                <div class="card-footer bg-light">
                    <a th:href="@{/solicitudes/nueva/{id}(id=${evento.id})}" class="btn btn-primary w-100">
                        <i class="bi bi-send"></i> Solicitar Stand
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Información adicional -->
    <div class="alert alert-warning mt-4">
        <i class="bi bi-exclamation-triangle"></i>
        <strong>Importante:</strong>
        <ul class="mb-0 mt-2">
            <li>Solo puede solicitar <strong>un stand por evento</strong></li>
            <li>Su solicitud estará <strong>pendiente de aprobación</strong> por el organizador</li>
            <li>Recibirá notificación cuando su solicitud sea aprobada o rechazada</li>
            <li>Puede cancelar solicitudes pendientes desde "Mis Solicitudes"</li>
        </ul>
    </div>
</div>

<footer class="text-center text-white mt-5">
    <small>© 2025 ExpoGest. Todos los derechos reservados.</small>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>